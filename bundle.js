(()=>{const e=document.querySelector("[data-projects]"),t=document.querySelector("[data-new-project-form]"),o=document.querySelector("[data-new-project-input]"),d=document.querySelector("[data-delete-project-button]"),n=document.querySelector("[data-delete-todo-button]"),a=document.querySelector("[data-project-dsplay-container]"),r=document.querySelector("[data-project-title]"),c=document.querySelector("[data-todos]"),l=document.getElementById("todo-template"),i=document.querySelector("[data-new-todo-form]"),u=document.querySelector("[data-new-todo-title-input]"),s=document.querySelector("[data-new-todo-desc-input]"),p=document.querySelector("[data-new-todo-prior-input]"),m=document.querySelector("[data-new-todo-date-input]"),S=document.querySelector("[data-new-todo-time-input]"),y=document.querySelector("[data-new-todo-note-input]"),f=document.querySelector("[data-todo-desc]"),v=document.querySelector("[data-desc]"),q="todos.projects",g="todos.selectedProjectId";let w=JSON.parse(localStorage.getItem(q))||[],j=localStorage.getItem(g);function h(){localStorage.setItem(q,JSON.stringify(w)),localStorage.setItem(g,j),E()}function E(){L(e),w.forEach((t=>{const o=document.createElement("li");o.dataset.projectId=t.id,o.classList.add("project-name"),o.innerText=t.name,t.id===j&&o.classList.add("active-project"),e.appendChild(o)}));const t=w.find((e=>e.id===j));null==j?a.style.display="none":(a.style.display="",r.innerText=t.name,L(c),function(e){e.todos.forEach((e=>{const t=document.importNode(l.content,!0),o=t.querySelector("ul");o.id=e.id,o.append(e.name),c.appendChild(t)}))}(t))}function L(e){for(;e.firstChild;)e.removeChild(e.firstChild)}c.addEventListener("click",(e=>{var t;"ul"===e.target.tagName.toLowerCase()&&(t=w.find((e=>e.id===j)).todos.find((t=>t.id===e.target.id)),L(v),v.append(t.name),v.append(t.desc),v.append(t.prior),v.append(t.date),v.append(t.time),v.append(t.note),f.appendChild(v))})),n.addEventListener("click",(e=>{const t=w.find((e=>e.id===j));t.todos=t.todos.filter((e=>e.id==t.todos.id)),h()})),e.addEventListener("click",(e=>{"li"===e.target.tagName.toLowerCase()&&(j=e.target.dataset.projectId,h())})),d.addEventListener("click",(e=>{w=w.filter((e=>e.id!==j)),j=null,h()})),t.addEventListener("submit",(e=>{e.preventDefault();const t=o.value;if(null==t||""===t)return;const d=(n=t,{id:Date.now().toString(),name:n,todos:[]});var n;o.value=null,w.push(d),h()})),i.addEventListener("submit",(e=>{e.preventDefault();const t=u.value,o=s.value,d=p.value,n=m.value,a=S.value,r=y.value;if(null==t||""===t)return;const c=(l=t,f=o,v=d,q=n,g=a,E=r,{id:Date.now().toString(),name:l,desc:f,prior:v,date:q,time:g,note:E});var l,f,v,q,g,E;u.value=null,w.find((e=>e.id===j)).todos.push(c),h(),i.reset()})),E()})();